% Español
\usepackage[spanish]{babel}
\usepackage{lmodern}
\usepackage[utf8]{inputenc}

% Imágenes
\usepackage[pdftex]{graphicx}
\usepackage{latexsym}
\usepackage{fancybox}

% Ruta para las imágenes
\graphicspath{{imagenes/}}

% Rotaciones
\usepackage[twoside]{rotating}

% Referencias
\usepackage[spanish]{varioref}
\usepackage[pdftex,colorlinks=true,linkcolor=black]{hyperref}

% Colores
\usepackage{color}
\usepackage{colortbl}

% Párrafos
\setlength{\parskip}{6pt}

% Entorno Listings para código fuente
\usepackage{listingsutf8}[2007/11/11]

\lstset{
  frame=Ltb, %forma del cuadro
  framerule=0pt, %ancho del borde
  aboveskip=0.5cm, %separación de los números de línea
  framexleftmargin=0.4cm, %margen externo izquierdo
  framesep=0pt,
  rulesep=.4pt,
  rulesepcolor=\color{black},
  % 
  stringstyle=\ttfamily,
  showstringspaces = false,
  basicstyle=\scriptsize,
  keywordstyle=\bfseries,
  % 
  numbers=left,
  numbersep=15pt,
  numberstyle=\tiny,
  numberfirstline= false,
  %
  inputencoding=utf8/latin1
}

% minimizar fragmentado de listados
\lstnewenvironment{listing}[1][]{
  \lstset{#1}\pagebreak[0]}{\pagebreak[0]
}


% Fancyhdr - Encabezados y pies de página
\usepackage{fancyhdr}
% Márgenes
\headsep=8mm
\footskip=14mm

% Fancy Header Style Options
\pagestyle{fancy}               % Sets fancy header and footer
\fancyfoot{}                    % Delete current footer settings

% Sin mayúsculas en la cabecera
\lhead{\nouppercase{\rightmark}}
\rhead{\nouppercase{\leftmark}}

% Capítulo
\renewcommand{\chaptermark}[1]{ % Lower Case Chapter marker style
  \markboth{\chaptername\ \thechapter.\ #1}{}} 

% Sección
\renewcommand{\sectionmark}[1]{ % Lower case Section marker style
  \markright{\thesection.\ #1}} 

% Página
\fancyhead[LE,RO]{\bfseries\thepage} % Page number (boldface) in left on even
                                     % pages and right on odd pages

% ------------------ Macro para encabezados y pies de página-------------------
%    Uso: \encabezado{pares(pag izquierda)}
% -----------------------------------------------------------------------------
\def\encabezado{
  \fancyhead[RE]{\bfseries\leftmark}     % In the right on even pages
  \fancyhead[LO]{\bfseries\rightmark}  % In the left on odd pages
  \renewcommand{\headrulewidth}{0.5pt} % Width of head rule
}
% -----------------------------------------------------------------------------


% ------------------ Macro para insertar una imagen ---------------------------
%    Uso: \imagen{nombreFichero}{Ancho(cm))}{Etiqueta}{Identificador}
% -----------------------------------------------------------------------------
\usepackage{float}
\usepackage{ifthen}
\def\imagen#1#2#3#4{
  \begin{figure}[H]
    \begin{center}
      \ifthenelse{\equal{#2}{}}
      {\includegraphics{#1}}{\resizebox{#2cm}{!}{\includegraphics{#1}}}
      \ifthenelse{\equal{#3}{}}{}{\caption{#3}}
      \label{#4}
    \end{center}
  \end{figure}
}
% -----------------------------------------------------------------------------


% ------------------ Macro para la portada ------------------------------------
%    Uso: \portada{asignatura}{titulo}{subtítulo}{autor}{fecha}
% -----------------------------------------------------------------------------
\def\portada#1#2#3#4#5{
  \thispagestyle{empty}
  \vspace*{-3.3cm}

  \begin{minipage}[t]{14cm}
    \begin{center}
      \includegraphics[scale=0.25]{logoesi}
  
      \vspace*{1.5cm}
      {\Large \textbf{Universidad de Castilla-La Mancha\\ 
          Escuela Superior de Informática}\\}
    
      \vspace*{1.2cm}
      {\huge \textbf{#1}\\}
    
      \vspace*{1.5cm}
      {\huge #2}\\{\Large #3\\}
    
      \vspace*{1.5cm}
      {\large #4\\}
      \vspace*{1.4cm}
      \large{#5}
    \end{center}
  \end{minipage}

  \newpage
  \vspace*{1cm}
  \thispagestyle{empty} 
  \newpage
}
% -----------------------------------------------------------------------------

% ------------------ Macro para la licencia -----------------------------------
%    Uso: \portada{asignatura}{titulo}{subtítulo}{autor}{fecha}
% -----------------------------------------------------------------------------
\def\licencia#1{
  \thispagestyle{empty}  % Suprime la numeración de esta página
  \vspace*{16cm}
  \begin{small}
    \copyright~ #1. Se permite la copia, distribución y/o 
    modificación de este documento bajo los términos de la licencia de
    documentación libre GNU, versión 1.1 o cualquier versión posterior publicada
    por la {\em Free Software Foundation}, sin secciones invariantes. Puede
    consultar esta licencia en http://www.gnu.org. \\[0.2cm]
    Este documento fue compuesto con \LaTeX{}. 
  \end{small}
  \newpage
  \thispagestyle{empty}
  \vspace*{0cm}
  \newpage
}
% -----------------------------------------------------------------------------

% Code for creating empty pages
% No headers on empty pages before new chapter
\makeatletter
\def\cleardoublepage{\clearpage\if@twoside \ifodd\c@page\else
    \hbox{}
    \thispagestyle{empty}
    \newpage
    \if@twocolumn\hbox{}\newpage\fi\fi\fi}
\makeatother \clearpage{\pagestyle{empty}\cleardoublepage}
